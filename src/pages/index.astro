---
// src/pages/index.astro
import Base from "../layouts/Base.astro";
import { getCollection } from "astro:content";
import SubjectGrid from "../components/SubjectGrid";

const subjects = (await getCollection("subjects")).sort(
  (a, b) => (a.data.order ?? 999) - (b.data.order ?? 999)
);

// При желании можно посчитать количество курсов на предмет:
const courses = await getCollection("courses");
const counts = new Map<string, number>();
for (const c of courses) {
  const s = c.data.subject;
  counts.set(s, (counts.get(s) ?? 0) + 1);
}

const items = subjects.map((s) => ({
  slug: s.data.slug,
  title: s.data.title,
  emoji: s.data.emoji,
  coursesCount: counts.get(s.data.slug) ?? 0,
}));
---

<Base title="Предметы">
  <h1 class="mb-6 text-2xl font-semibold">Предметы</h1>
  <SubjectGrid client:load items={items} />
</Base>
